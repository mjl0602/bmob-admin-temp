(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d4a9"],{"42BQ":function(e,t,r){"use strict";r.r(t);var n=r("14Xm"),a=r.n(n),i=r("FyfS"),s=r.n(i),l=r("D3Ub"),o=r.n(l),u=r("iCc5"),c=r.n(u),d=r("V7oC"),p=r.n(d),f=r("t6Sf"),m=(r("mRI9"),{filters:{},mixins:[f.a],data:function(){return{objStr:"问卷结果",source:new g,query:{pageSize:5}}},methods:{}}),g=function(){function e(){c()(this,e),this.defaultObject={leftVision:0,rightVision:0,macula:0,hyperopia:0,amblyopia:0,astigmatism:0,colorBlindness:0,nightBlindness:0,lateralStrabismus:0,medialStrabismus:0,ocularSensation:0,flyingMidge:0},this.rules={leftVision:[{required:!0,message:"必填",trigger:"blur"}],rightVision:[{required:!0,message:"必填",trigger:"blur"}],macula:[{required:!0,message:"必填",trigger:"blur"}],hyperopia:[{required:!0,message:"必填",trigger:"blur"}],amblyopia:[{required:!0,message:"必填",trigger:"blur"}],astigmatism:[{required:!0,message:"必填",trigger:"blur"}],colorBlindness:[{required:!0,message:"必填",trigger:"blur"}],nightBlindness:[{required:!0,message:"必填",trigger:"blur"}],lateralStrabismus:[{required:!0,message:"必填",trigger:"blur"}],medialStrabismus:[{required:!0,message:"必填",trigger:"blur"}],ocularSensation:[{required:!0,message:"必填",trigger:"blur"}],flyingMidge:[{required:!0,message:"必填",trigger:"blur"}]}}return p()(e,[{key:"all",value:function(){var e=o()(a.a.mark(function e(t){var r,n,i,l,o,u,c,d,p,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Bmob.Query("result")).include("user"),e.next=4,r.count();case 4:return n=e.sent,t.page&&t.pageSize&&(r.skip(t.pageSize*(t.page-1)),r.limit(t.pageSize)),r.order("-createdAt"),e.next=9,r.find();case 9:for(i=e.sent,l=[],o=!0,u=!1,c=void 0,e.prev=14,d=s()(i);!(o=(p=d.next()).done);o=!0)f=p.value,l.push(this.parseResult(f));e.next=22;break;case 18:e.prev=18,e.t0=e.catch(14),u=!0,c=e.t0;case 22:e.prev=22,e.prev=23,!o&&d.return&&d.return();case 25:if(e.prev=25,!u){e.next=28;break}throw c;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",{total:n,data:l});case 31:case"end":return e.stop()}},e,this,[[14,18,22,30],[23,,25,29]])}));return function(t){return e.apply(this,arguments)}}()},{key:"parseResult",value:function(e){return console.log("格式化:",e),e.leftVision=(e.leftVision/100).toFixed(2),e.rightVision=(e.rightVision/100).toFixed(2),e.macula=this.lrFilter(e.macula),e.hyperopia=this.lrFilter(e.hyperopia),e.amblyopia=this.lrFilter(e.amblyopia),e.astigmatism=this.lrFilter(e.astigmatism),e.flyingMidge=this.lrFilter(e.flyingMidge),e.strabismus=this.xFilter(e),e.colorBlindness=["正常","红绿色盲","全色盲"][e.colorBlindness],e.nightBlindness=0==e.nightBlindness?"正常":"夜盲",e.ocularSensation=["舒适清晰","一般般","模糊干涩"][e.ocularSensation],console.log("格式化结束:",e),e}},{key:"lrFilter",value:function(e){return"左眼:"+(e>=10?"❌":"✅")+" 右眼:"+(e%10==1?"❌":"✅")}},{key:"xFilter",value:function(e){var t={in:e.lateralStrabismus>=10?"内侧斜视":"",out:e.lateralStrabismus%10==1?"外侧斜视":""},r={in:e.medialStrabismus>=10?"内侧斜视":"",out:e.medialStrabismus%10==1?"外侧斜视":""};return"左:"+(t.in+t.out||"正常")+"  右:"+(r.in+r.out||"正常")}},{key:"edit",value:function(){var e=o()(a.a.mark(function e(t){var r,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bmob.Query("result"),e.next=3,r.get(t.objectId);case 3:return(n=e.sent).set("leftVision",parseInt(t.leftVision)),n.set("rightVision",parseInt(t.rightVision)),n.set("macula",parseInt(t.macula)),n.set("hyperopia",parseInt(t.hyperopia)),n.set("amblyopia",parseInt(t.amblyopia)),n.set("astigmatism",parseInt(t.astigmatism)),n.set("colorBlindness",parseInt(t.colorBlindness)),n.set("nightBlindness",parseInt(t.nightBlindness)),n.set("lateralStrabismus",parseInt(t.lateralStrabismus)),n.set("medialStrabismus",parseInt(t.medialStrabismus)),n.set("ocularSensation",parseInt(t.ocularSensation)),n.set("flyingMidge",parseInt(result.flyingMidge)),e.abrupt("return",n.save());case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=o()(a.a.mark(function e(t){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Bmob.Query("result")).set("leftVision",parseInt(t.leftVision)),r.set("rightVision",parseInt(t.rightVision)),r.set("macula",parseInt(t.macula)),r.set("hyperopia",parseInt(t.hyperopia)),r.set("amblyopia",parseInt(t.amblyopia)),r.set("astigmatism",parseInt(t.astigmatism)),r.set("colorBlindness",parseInt(t.colorBlindness)),r.set("nightBlindness",parseInt(t.nightBlindness)),r.set("lateralStrabismus",parseInt(t.lateralStrabismus)),r.set("medialStrabismus",parseInt(t.medialStrabismus)),r.set("ocularSensation",parseInt(t.ocularSensation)),r.set("flyingMidge",parseInt(result.flyingMidge)),e.abrupt("return",r.save());case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteObj",value:function(){var e=o()(a.a.mark(function e(t){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Bmob.Query("result"),e.abrupt("return",r.destroy(t.objectId));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),b=m,h=(r("SUae"),r("KHd+")),v=Object(h.a)(b,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"filter-container"},[r("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.add}},[e._v("添加")])],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{label:"性别",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(["","女","男"][t.row.user.sex]))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"姓名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.user.name))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"左眼视力",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.leftVision))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"右眼视力",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.rightVision))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"黄斑",align:"center",width:"88"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.macula))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"远视",align:"center",width:"88"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.hyperopia))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"弱视",align:"center",width:"88"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.amblyopia))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"散光",align:"center",width:"88"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.astigmatism))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"飞蚊症",align:"center",width:"88"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.flyingMidge))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"色盲",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.colorBlindness))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"夜盲症",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.nightBlindness))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"斜视",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.strabismus))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"眼部感觉",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.ocularSensation))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"创建日期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.createdAt))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"更新日期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.updatedAt))]}}])}),e._v(" "),r("el-table-column",{attrs:{"class-name":"status-col",label:"操作",align:"center",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button-group",[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){e.edit(t.row)}}},[e._v("修改")]),e._v(" "),r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){e.deleteRow(t.row)}}},[e._v("删除")])],1)]}}])})],1),e._v(" "),e.query.total?r("div",{staticClass:"pagination-container"},[r("el-pagination",{attrs:{"current-page":e.query.pageNum,"page-sizes":[5,10,20,30,50],"page-size":e.query.pageSize,total:e.query.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e(),e._v(" "),r("el-dialog",{attrs:{visible:e.addDialogVisible,title:e.dialogTitle},on:{"update:visible":function(t){e.addDialogVisible=t}}},[r("el-form",{staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:e.row,rules:e.rules,"label-position":"left","label-width":"100px"}},[r("el-form-item",{attrs:{label:"左眼视力",prop:"leftVision"}},[r("el-input",{attrs:{placeholder:"请输入左眼视力"},model:{value:e.row.leftVision,callback:function(t){e.$set(e.row,"leftVision",t)},expression:"row.leftVision"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"右眼视力",prop:"rightVision"}},[r("el-input",{attrs:{placeholder:"请输入右眼视力"},model:{value:e.row.rightVision,callback:function(t){e.$set(e.row,"rightVision",t)},expression:"row.rightVision"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"黄斑",prop:"macula"}},[r("el-input",{attrs:{placeholder:"请输入黄斑"},model:{value:e.row.macula,callback:function(t){e.$set(e.row,"macula",t)},expression:"row.macula"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"远视",prop:"hyperopia"}},[r("el-input",{attrs:{placeholder:"请输入远视"},model:{value:e.row.hyperopia,callback:function(t){e.$set(e.row,"hyperopia",t)},expression:"row.hyperopia"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"弱视",prop:"amblyopia"}},[r("el-input",{attrs:{placeholder:"请输入弱视"},model:{value:e.row.amblyopia,callback:function(t){e.$set(e.row,"amblyopia",t)},expression:"row.amblyopia"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"散光",prop:"astigmatism"}},[r("el-input",{attrs:{placeholder:"请输入散光"},model:{value:e.row.astigmatism,callback:function(t){e.$set(e.row,"astigmatism",t)},expression:"row.astigmatism"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"色盲",prop:"colorBlindness"}},[r("el-input",{attrs:{placeholder:"请输入色盲"},model:{value:e.row.colorBlindness,callback:function(t){e.$set(e.row,"colorBlindness",t)},expression:"row.colorBlindness"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"夜盲症",prop:"nightBlindness"}},[r("el-input",{attrs:{placeholder:"请输入夜盲症"},model:{value:e.row.nightBlindness,callback:function(t){e.$set(e.row,"nightBlindness",t)},expression:"row.nightBlindness"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"左眼斜视",prop:"lateralStrabismus"}},[r("el-input",{attrs:{placeholder:"请输入左眼斜视"},model:{value:e.row.lateralStrabismus,callback:function(t){e.$set(e.row,"lateralStrabismus",t)},expression:"row.lateralStrabismus"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"右眼斜视",prop:"medialStrabismus"}},[r("el-input",{attrs:{placeholder:"请输入右眼斜视"},model:{value:e.row.strabismus,callback:function(t){e.$set(e.row,"strabismus",t)},expression:"row.strabismus"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"飞蚊症",prop:"flyingMidge"}},[r("el-input",{attrs:{placeholder:"请输入飞蚊症"},model:{value:e.row.flyingMidge,callback:function(t){e.$set(e.row,"flyingMidge",t)},expression:"row.flyingMidge"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"眼部感觉",prop:"ocularSensation"}},[r("el-input",{attrs:{placeholder:"请输入眼部感觉"},model:{value:e.row.ocularSensation,callback:function(t){e.$set(e.row,"ocularSensation",t)},expression:"row.ocularSensation"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)},[],!1,null,null,null);v.options.__file="resultManage.vue";t.default=v.exports},G1xj:function(e,t,r){},"RU/L":function(e,t,r){r("Rqdy");var n=r("WEpk").Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},Rqdy:function(e,t,r){var n=r("Y7ZC");n(n.S+n.F*!r("jmDH"),"Object",{defineProperty:r("2faE").f})},SEkw:function(e,t,r){e.exports={default:r("RU/L"),__esModule:!0}},SUae:function(e,t,r){"use strict";var n=r("G1xj");r.n(n).a},V7oC:function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("SEkw"));t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,n.default)(e,a.key,a)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},iCc5:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},mRI9:function(e,t,r){"use strict";var n=r("4d7F"),a=r.n(n),i=r("iCc5"),s=r.n(i),l=r("V7oC"),o=r.n(l);function u(){return{id:parseInt(10*Math.random()),title:"Title#"+parseInt(1e5*Math.random())}}var c=function(){function e(){s()(this,e)}return o()(e,null,[{key:"all",value:function(){return d([u(),u(),u()])}},{key:"edit",value:function(e){return d("修改结果")}},{key:"add",value:function(e){return d("添加结果")}},{key:"deleteObj",value:function(e){return d("删除结果")}}]),e}();function d(e){return console.log("模拟返回"),new a.a(function(t,r){t(e)})}c.defaultObject={},c.rules={},t.a=c},t6Sf:function(e,t,r){"use strict";var n=r("4d7F"),a=r.n(n),i=r("P2sY"),s=r.n(i),l=r("14Xm"),o=r.n(l),u=r("D3Ub"),c=r.n(u),d=r("mRI9");t.a={computed:{dialogTitle:function(){return(this.isNew?"新增":"修改")+this.objStr}},filters:{},data:function(){return{objStr:"#对象#",list:[],listLoading:!0,query:{total:0,pageSize:5,page:1},addDialogVisible:!1,isNew:!1,row:{},rules:{},source:d.a,datePickOption:{shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]}}},created:function(){this.queryAll()},methods:{queryAll:function(){var e=this;return c()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.prev=1,t.next=4,e.source.all(e.query);case 4:(r=t.sent).total?(e.list=r.data,e.query.total=r.total):e.list=r,console.log("查询数据:",e.list),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(1),console.error(t.t0),e.notifyError("查询失败","查询数据时发生错误"),e.listLoading=!1;case 14:e.listLoading=!1;case 15:case"end":return t.stop()}},t,e,[[1,9]])}))()},add:function(){var e=this;return c()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.isNew=!0,e.row=s()({},e.source.defaultObject),e.rules=d.a.rules,e.addDialogVisible=!0;case 4:case"end":return t.stop()}},t,e)}))()},edit:function(e){console.log("edit",e),this.isNew=!1,this.row=s()({},e),this.rules=d.a.rules,this.addDialogVisible=!0},submit:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.row;return c()(o.a.mark(function r(){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(console.log("###submit",t,e.isNew),r.prev=1,!e.isNew){r.next=9;break}return console.log("add"),r.next=6,e.source.add(e.row);case 6:e.notifySuccess("新增成功","成功新增"+e.objStr),r.next=13;break;case 9:return console.log("edit"),r.next=12,e.source.edit(e.row);case 12:e.notifySuccess("修改成功",e.objStr+"修改成功");case 13:r.next=19;break;case 15:r.prev=15,r.t0=r.catch(1),console.error(r.t0),e.notifyError("失败","操作发生错误，数据提交失败.");case 19:return e.addDialogVisible=!1,r.next=22,e.queryAll();case 22:case"end":return r.stop()}},r,e,[[1,15]])}))()},deleteRow:function(e){var t=this;return c()(o.a.mark(function r(){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("删除操作将不能撤销, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"});case 2:return r.next=4,t.source.deleteObj(e);case 4:return t.notifySuccess("删除成功",t.objStr+"已被删除"),r.next=7,t.queryAll();case 7:case"end":return r.stop()}},r,t)}))()},handleSizeChange:function(e){this.query.page=1,this.query.pageSize=e,console.log("handleSizeChange",e),this.queryAll()},handleCurrentChange:function(e){this.query.page=e,console.log("handleCurrentChange",e),this.queryAll()},goback:function(){this.$router.go(-1)},notifyError:function(e,t){this.$notify({title:e,message:t,type:"error",duration:2e3})},notifyWarning:function(e,t){this.$notify({title:e,message:t,type:"warning",duration:2e3})},notifySuccess:function(e,t){this.$notify({title:e,message:t,type:"success",duration:2e3})},needInterface:function(){this.$notify({title:"等待开发",message:"需要后台接口",type:"warning",duration:2e3})},fakePromise:function(){return new a.a(function(e,t){e()})}}}}}]);